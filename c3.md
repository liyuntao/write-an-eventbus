上一章节我们定义了EventBus所需的核心API，并初步分析了三个核心方法的实现逻辑，与Method对象的存储细节。

接下来我们按部就班，进行一些具体的实现：


## 创建注解

EventBus使用注解来标记订阅方法，所以首先，我们需要创建这样一个注解：
* 注解用来标记订阅方法，所以它的作用域位于方法之上
* `register()`方法会在应用的运行期查找所有被注解的方法，所以该注解需要保留到运行时

```java
@Retention(RetentionPolicy.RUNTIME) // 保留策略：将这个注解保留到运行时
@Target(ElementType.METHOD) // 作用目标：注解适用于方法
public @interface Subscribe {
}
```

## register()实现

## unregister()实现

## post()实现

结合前面分析，`post()`的实现就很简单了。根据入参从map中拿到所有method对象，反射调用即可。代码如下：
```java
public void post(Object event) {
        Class<?> type = event.getClass();
        Set<EventInfo> eventInfos = m.get(type);
        for (EventInfo eventInfo : eventInfos) {
            Method method = eventInfo.getMethod();
            try {
                method.invoke(eventInfo.getTarget(), event);
            } catch (IllegalAccessException e) {
                e.printStackTrace();
            } catch (InvocationTargetException e) {
                e.printStackTrace();
            }
        }
    }
```
